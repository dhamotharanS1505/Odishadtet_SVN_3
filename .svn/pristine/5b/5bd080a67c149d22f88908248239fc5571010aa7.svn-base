﻿
@{
    ViewBag.Title = "SubjectActivationHistoryReport";
    Layout = "~/Views/Shared/_LearnEnggAdminLayout.cshtml";
}

<style type="text/css">
    .row {
        margin-left: -15px;
        margin-right: -15px;
    }

    .refno {
        color: #0066c0 !important;
        text-decoration: none;
    }

    .ui-state-default.ui-jqgrid-pager.ui-corner-bottom {
        width: 1049px !important;
    }

    .ui-state-default.ui-jqgrid-toppager {
        width: 1049px !important;
    }


    .ui-dialog .ui-dialog-buttonpane button {
        cursor: pointer;
        margin: 0.5em 0.4em 0.5em 0;
        padding: 4px;
    }

    .col-sm-6 > select {
        border: 1px solid #000;
        border-radius: 1px !important;
        margin: 1px !important;
        width: 70%;
        padding: 4px;
        background: rgba(0, 0, 0, 0) url("../Content/img/v1.png") no-repeat scroll right center;
        -moz-appearance: none;
    }

    .ui-dialog-titlebar.ui-widget-header.ui-corner-all.ui-helper-clearfix.ui-draggable-handle > button {
        background: #fff none repeat scroll 0 0;
        margin-left: 7%;
        padding: 0;
        top: 0 !important;
    }

    #printbtn {
        float: right;
        margin-right: 0px;
    }


    .ui-dialog-content.ui-widget-content {
        height: 400px;
        max-height: none;
        min-height: 0;
        width: auto;
    }

    fieldset.scheduler-border {
        border: 1px groove #ddd !important;
        border-radius: 4px;
        box-shadow: 0 0 0 0 #000;
        margin: 15px 0;
        padding: 15px;
    }

    legend.scheduler-border {
        font-size: 1.2em !important;
        font-weight: bold !important;
        text-align: left !important;
        width: auto;
        padding: 0 10px;
        border-bottom: none;
    }

    .scheduler-border legend {
        margin-bottom: 0px !important;
    }

    #ordersdetails table {
        font-size: 13px;
        width: 100%;
    }

    #ordersdetails tfoot {
        font-weight: bold;
    }

    #ordersdetails span strong {
        font-size: 13px;
        font-weight: normal;
    }

    #ordersdetails table td:nth-child(2) {
        text-align: right;
    }

    #ordersdetails ul {
        list-style: outside none none;
        margin: 0;
        padding: 0;
    }

        #ordersdetails ul li {
            font-size: 13px;
            line-height: 1.5;
            margin: 0;
            padding: 0;
        }

    .css-serial {
        counter-reset: serial-number; /* Set the serial number counter to 0 */
    }

        .css-serial table tr td:nth-child(1) {
            counter-increment: serial-number; /* Increment the serial number counter */
            content: counter(serial-number); /* Display the counter */
        }


    .panel-default > .panel-heading {
        background-image: linear-gradient(to bottom, #00acc2 0%, #00acc2 100%);
        background-repeat: repeat-x;
        color: #fff;
        text-transform: uppercase;
        font-size: 12px;
        font-weight: normal;
    }

    table {
        width: 100%;
        border-collapse: collapse;
        border-spacing: 0;
        overflow: hidden;
        background-color: transparent;
    }


    #univname {
        text-transform: uppercase;
        font-weight: 600;
        font-size: 14px;
    }

    /*any os other than mac*/
    tbody {
        overflow-y: auto;
        width: 100%;
    }

    /*any os other than mac*/
    thead {
        width: 100%;
        padding-right: 17px;
    }


    tbody {
        border-top: 1px solid black;
    }

    body {
        color: #333 !important;
        font-family: "Helvetica Neue",Helvetica,Arial,sans-serif;
        font-size: 14px;
        line-height: 1.42857;
    }




    .paging-nav {
        text-align: right;
        padding-top: 2px;
    }

    .tbl_wdith {
        width: 100% !important;
    }

    .paging-nav a {
        margin: auto 1px;
        text-decoration: none;
        display: inline-block;
        padding: 1px 7px;
        background: #91b9e6;
        color: white;
        border-radius: 3px;
    }

    .paging-nav .selected-page {
        background: #187ed5;
        font-weight: bold;
    }

    .txt_spn_wrp {
        display: block;
        min-width: 500px;
        text-align: center;
    }
</style>



<article class="col-sm-12">

    <div class="in_hd_tt row">
        <strong class="fa fa-file-text"></strong><span>Subject Activation Report</span> <span style="float: right;" class="wi_cl_ul" id="fine_drp_3">
        </span>
    </div>

</article>

<article class="col-sm-12">
    <section class="sub_wrp row">
        <div class="panel panel-default height">
            <div class="panel-heading">
                <strong>University Wise Subject Activation Report</strong>
            </div>
            <article class="inv_data_tbwrp-main">
                <div id="sortMsg" style="text-align: center; color: Red;">
                </div>

                <table id="table_master_main" class="table table-striped table-bordered sortable tbl_wdith" cellspacing="0">
                    <thead>
                        <tr>
                            <th>
                                S.No
                            </th>
                            <th style="width:40%;">
                                University Name
                            </th>
                            <th>
                                Total users
                            </th>
                            <th>
                                Total Content
                            </th>
                            <th>
                                Total Q/A
                            </th>
                        </tr>
                    </thead>
                    <tbody class="tab_1_bdy" id="FixUniversityWise"></tbody>
                </table>
                <div id="pager"></div>
            </article>
        </div>
    </section>
</article>
<article id="DatewiseReport" class="col-sm-12">
    <section class="sub_wrp row">
        <div class="panel panel-default height">
            <div class="panel-heading">
                <strong>Date Wise Subject Activation Report</strong>
            </div>
            <article class="inv_data_tbwrp-main">
                <div class="row">
                    <div class="col-lg-6 txt_spn_wrp">
                        <strong>University Name:</strong>&nbsp; <span id="univname"></span>
                    </div>

                    <div class="col-lg-5 txt_spn_wrp">
                        <strong><button type="button" id="dtnReport" class="btn btn-primary btn-sm pull-right">Download Report</button> </strong>&nbsp; 
                    </div>
                   
                </div>
                <div class="row"> &nbsp;</div>
                    <div class="row">
                        <div class="col-lg-12">
                            <table id="Activation_History_datewise" class="table table-striped table-bordered sortable css-serial tbl_wdith" cellspacing="0">
                                <thead class="tab_2">
                                    <tr>
                                        <th>S.NO</th>
                                        <th>Date</th>
                                        <th>Total users</th>
                                        <th>Total Content</th>
                                        <th>Total Question & Answer</th>
                                        <th>Activated by</th>
                                        <th style="border-right:none;">Activated for</th>
                                    </tr>
                                </thead>
                                <tbody class="tab_body" id="FixDateWise"></tbody>
                            </table>
                        </div>
                    </div>
</article>
        </div>

    </section>
</article>
<div class="modal fade col-sm-12" id="modelpopupActivationBy" style="display:none;">
    <div class="modal-dialog modal-content">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 id="Quick" class="pop_hed" style="align-content:center">
                Subject Activation By Details
            </h4>
        </div>
        <span>
            <br />
            <span style="margin:24px;">
                <strong>Activation On :</strong>
                <span class="FixActivation_on"></span>
                <strong>Activation By :</strong>
                <span class="FixActivation_by"></span>
            </span>
        </span>

        <div class="modal-body clearfix row ">
            <div class="col-sm-12  table-class">
                <table id="Avtivation_history_by" class="table table-striped table-bordered sortable tbl_wdith" cellspacing="0">
                    <thead id="thead">
                        <tr role="row">
                            @*<td><input id="selectCheck" type="checkbox" class="chk" name="checkAll" /> Select All</td>*@
                            <th>
                                S.No
                            </th>
                            <th>
                                User Name
                            </th>
                            <th>
                                Total Users
                            </th>
                            <th>
                                Total Items
                            </th>
                            <th>
                                Total Content
                            </th>
                            <th>
                                Total Question & Answer
                            </th>
                            <th>
                                University
                            </th>
                        </tr>
                    </thead>
                    <tbody id="FixActivationByDetails"></tbody>
                </table>
            </div>
        </div>

    </div>
</div>


<div class="modal fade col-sm-12" id="modelpopupActivationFor" display:none;">
    <div class="modal-dialog modal-content">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 id="Quick" class="pop_hed" style="align-content:center">
                Subject Activation For Details
            </h4>
        </div>
        <span>
            <br />
            <span style="margin:24px;">
                <strong>Activation On:</strong>&nbsp;<span class="FixActivation_on"> </span>
            </span>
        </span>
        <div>
            <div class="modal-body clearfix row ">
                <div class="col-sm-12  table-class">
                    <table id="Avtivation_history_for" class="table table-striped table-bordered sortable tbl_wdith" cellspacing="0">
                        <thead id="thead">
                            <tr role="row">
                                @*<td><input id="selectCheck" type="checkbox" class="chk" name="checkAll" /> Select All</td>*@
                                <th>S.NO</th>
                                <th>
                                    Name(Student / Staff)
                                </th>
                                <th>
                                    Subject Name
                                </th>
                                <th>
                                    Subject Type
                                </th>
                                <th>
                                    Subject Extended date
                                </th>
                                <th>
                                    Activated by
                                </th>
                                <th>
                                    University
                                </th>
                            </tr>
                        </thead>
                        <tbody id="FixActivationForDetails"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>



<script id="BindUniversityWise" type="text/html">

    <tr>
        <td>${serialno}</td>
        <td>
            <a href="#" id="univiersityid" class="btndatewise" rel="${universityId}~${Universityname}" style="color:#0066c0;" aria-hidden="true">${Universityname}</a>
        </td>
        <td> ${userId}</td>
        <td> ${TotalContent}</td>
        <td> ${TotalQuestionAnswer}</td>
    </tr>
</script>

<script id="BindDateWise" type="text/html">

    <tr>
        <td>${serialno}</td>
        <td>${activatedon}</td>
        <td> ${userId}</td>
        <td> ${TotalContent}</td>
        <td> ${TotalQuestionAnswer}</td>
        <td>
            <a data-toggle="modal" title="Subject Activation By User Details" style="color:#0066c0 !important;text-decoration:none;" href="#modelpopupActivationBy" id="btnactivationbyuserdetails" rel="${activatedon}~${Activatedbyusername}~${universityId}">Details</a>
        </td>
        <td>
            <a data-toggle="modal" title="Subject Activation For User Details" style="color:#0066c0 !important;text-decoration:none;" href="#modelpopupActivationFor" id="btnactivationforuserdetails" rel=${activatedon}~${universityId}>Details</a>

        </td>
    </tr>
</script>

<script id="BindActivationByDetails" type="text/html">
    <tr>
        <td>${serialno}</td>
        <td>${Activatedforusername}</td>
        <td> ${userId}</td>
        <td> ${subjectid}</td>
        <td> ${TotalContent}</td>
        <td> ${TotalQuestionAnswer}</td>
        <td> ${Universityname}</td>
    </tr>
</script>

<script id="BindActivationForDetails" type="text/html">
    <tr>
        <td>${serialno}</td>
        <td>${Activatedforusername}</td>
        <td style="width:28%">${subjectname}</td>
        <td style="width:10%"> ${packagetype}</td>
        <td> ${subjectexpiryextensiondate}</td>
        <td style="width:12%" valign="middle"> ${Activatedbyusername}</td>
        <td> ${Universityname}</td>
    </tr>
</script>


<input type="hidden" id="usenameby" />
<script type="text/javascript">

    var University_id = 0;
    $(document).ready(function () {
        //subjectactivationhistory();
        $('#DatewiseReport').hide();
        UniversityWise_subjectactivationhistory();
        var serialno = 0;
        var OSName = "";
        if (navigator.appVersion.indexOf("Win") != -1) OSName = "Windows";

    });

    $(document).ready(function () {

        $('#dtnReport').click(function () {

            $('.loader').show();
            var univId = University_id;
            var ActStartDate = null;
            var ActEndDate = null;
            var UserRole = null;
            $('.loader').hide();
            window.location.href = "../AdminActivity/GetSubjectActivationHistory_DateWise_Details_Report?UnivId=" + univId + "&ActStartDate=" + ActStartDate + "&ActEndDate=" + ActEndDate + "&UserRole=" + UserRole;

        })      

    })


    //----------------Load Subject activation Details in University Wise---------------------------


    function UniversityWise_subjectactivationhistory() {
        $('#FixUniversityWise').empty();

        $('#table_master_main').DataTable({
            "bProcessing": true,
            "bDestroy": true
        }).fnClearTable();


        var row = 0;
        $.getJSON("/APIService/APIAdminActivity/GetSubjectActivationHistory_UniversityWise_Report",
          {

          }, function (data) {
              $.each(data, function (index, value) {
                  serialno = index + 1;
                  $("#BindUniversityWise").tmpl(value).appendTo("#FixUniversityWise");

              });

              $('#table_master_main').DataTable({
                  "bProcessing": true,
                  "bDestroy": true
              });

          });


    }

    //----------------Load Subject activation Details in Date Wise-----------------------------

    $(document).on('click', '.btndatewise', function () {
        $('#DatewiseReport').show();
        $('#FixDateWise').empty();

        $('#Activation_History_datewise').DataTable({
            "bProcessing": true,
            "bDestroy": true
        }).fnClearTable();

        var univID = $(this).attr('rel').split('~')[0];
        $('#FixActivationHistory').empty();
        var Universityname = $(this).attr('rel').split('~')[1];
        $("#univname").text(Universityname);

        University_id = univID;

        $.getJSON("/APIService/APIAdminActivity/GetSubjectActivationHistoryReport",
          {
              UniversityId: univID
          }, function (data) {

              $.each(data, function (index, value) {
                  serialno = index + 1;
                  $("#BindDateWise").tmpl(value).appendTo("#FixDateWise");

              });
              $('#Activation_History_datewise').DataTable({
                  "bProcessing": true,
                  "bDestroy": true,
                  "aoColumnDefs": [{
                      'bSortable': false,
                      'aTargets': [1]
                  }]
              });

          });

    });


    $(document).on('click', '#btnactivationforuserdetails', function () {
        $('#FixActivationForDetails').empty();

        $('#Avtivation_history_for').DataTable({
            "bProcessing": true,
            "bDestroy": true
        }).fnClearTable();


        var activationon = $(this).attr('rel').split('~')[0];
        var univid = $(this).attr('rel').split('~')[1];
        $('.FixActivation_on').text(activationon);

        University_id = univid;

        $.getJSON("/APIService/APIAdminActivity/GetSubjectActivationy_For_HistorReportDetails",
         {
             UnivId: univid,
             Date: activationon

         }, function (data) {
             $.each(data, function (index, value) {
                 serialno = index + 1;
                 $("#BindActivationForDetails").tmpl(value).appendTo("#FixActivationForDetails");
             });

             $('#Avtivation_history_for').DataTable({
                 "bProcessing": true,
                 "aLengthMenu": [[5, 10, 20, 50, 100, 200], [5, 10, 20, 50, 100, 200]],
                 "iDisplayLength": 5,
                 "bDestroy": true,
                 "aoColumnDefs": [{
                     'bSortable': false,
                     'aTargets': [4]
                 }]
             });

             /*pagging option */
             //$('#Avtivation_history_for').paging({
             //    limit: 5,
             //    rowDisplayStyle: 'block',
             //    activePage: 0,
             //    rows: []
             //});

         });
    });

    $(document).on('click', '#btnactivationbyuserdetails', function () {

        $('#FixActivationByDetails').empty();

        $('#Avtivation_history_by').DataTable({
            "bProcessing": true,
            "bDestroy": true
        }).fnClearTable();

        var activationon = $(this).attr('rel').split('~')[0];
        var activationby = $(this).attr('rel').split('~')[1];
        var univid = $(this).attr('rel').split('~')[2];

        University_id = univid;
        $('.FixActivation_on').text(activationon);
        $('.FixActivation_by').text(activationby);

        $.getJSON("/APIService/APIAdminActivity/GetSubjectActivation_By_HistoryReportDetails",
         {
             UnivId: univid,
             Date: activationon
         }, function (data) {
             $.each(data, function (index, value) {
                 // $('#usenameby').val(value.Activatedbyusername);
                 serialno = index + 1;
                 $("#BindActivationByDetails").tmpl(value).appendTo("#FixActivationByDetails");
             });
             $('#Avtivation_history_by').DataTable({
                 "bProcessing": true,
                 "bDestroy": true
             });

         });
    });

</script>
